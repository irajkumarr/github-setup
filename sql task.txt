Create a one-to-many and many-to-many relationship in a shopping store context using four tables:

customers

orders

products

order_items


Include a price column in the products table and display the relationship between customers and their orders, along with the details of the products in each order.

=> 
--creating the table for the customers
create table customers(
id serial primary key,
name varchar(50) not null
);

INSERT INTO customers (name)
VALUES
    ('Raju'), ('Sham'), ('Paul'), ('Alex');

-creating table for the products
create table products(
id serial primary key,
title varchar(100) not null,
price numeric not null
);

INSERT INTO products (title, price)
VALUES
    ('Laptop', 55000.00),
    ('Mouse', 500),
    ('Keyboard', 800.00),
    ('Cable', 250.00)
;

--creating table for the orders
create table orders(
id serial primary key,
customer int not null,
order_date date not null,
foreign key(customer) references customers(id)
);

INSERT INTO orders (order_date, customer)
VALUES
    ('2024-01-01', 1),  -- Raju first order
    ('2024-02-01', 2),  -- Sham first order
    ('2024-03-01', 3),  -- Paul first order
    ('2024-04-04', 2);  -- Sham second order

--creating table for the order_items
create table order_items(
id serial primary key,
order_id int not null,
product int not null,
quantity int not null,
foreign key(order_id) references orders(id),
foreign key(product) references products(id)
);

INSERT INTO order_items (order_id, product, quantity)
VALUES
    (1, 1, 1),  -- Raju ordered 1 Laptop
    (1, 4, 2),  -- Raju ordered 2 Cables
    (2, 1, 1),  -- Sham ordered 1 Laptop
    (3, 2, 1),  -- Paul ordered 1 Mouse
    (3, 4, 5),  -- Paul ordered 5 Cables
    (4, 3, 1);  -- Sham ordered 1 Keyboard


query:

select customers.name as customer,
orders.id as order,
orders.order_date,
products.title as product,
order_items.quantity,
products.price,
(products.price * order_items.quantity) as total_price
from order_items 
join orders on orders.id=order_items.order_id
join products on products.id=order_items.product
join customers on customers.id=orders.customer
;
